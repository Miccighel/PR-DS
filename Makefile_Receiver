REBAR = rebar
ERL = erl
CC = erlc
SRCDIR= src/
APP= project.app.src
BEAMDIR=ebin/

## Dipendenze ##
EMQTTC= deps/emqttc/ebin/*
GEN_LOGGER= deps/gen_logger/ebin/*
GETOPT= deps/getopt/ebin/*
GOLDRUSH= deps/goldrush/ebin/*
LAGER= deps/lager/ebin/*

all:
	@$(REBAR) get-deps;
	@$(REBAR) compile;
	@cp -r $(EMQTTC) $(BEAMDIR);
	@cp -r $(GEN_LOGGER) $(BEAMDIR);
	@cp -r $(GETOPT) $(BEAMDIR);
	@cp -r $(GOLDRUSH) $(BEAMDIR);
	@cp -r $(LAGER) $(BEAMDIR);
	@mkdir -p log;
	@ erlc -o $(BEAMDIR) $(SRCDIR)/*.erl;
	$(ERL) -pa $(BEAMDIR) -eval "application:start(project)" 

